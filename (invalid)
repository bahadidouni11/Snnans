from telegram import Update, ReplyKeyboardMarkup
from telegram.ext import ApplicationBuilder, CommandHandler, ContextTypes, MessageHandler, filters
import random

# ---------- CONFIG ----------
BOT_TOKEN = "8174026881:AAF3Z5I6PR2oD8PGpBGPogMtcy7TAoUDZ4s"

# ---------- USERS POINTS ----------
users_points = {}  # Ù„ØªØ®Ø²ÙŠÙ† Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†

# ---------- EVENT TASKS ----------
easy_tasks = ["Ø´Ø§Ù‡Ø¯ ÙÙŠØ¯ÙŠÙˆ Ù‡Ø§Ù„ÙˆÙŠÙ† ğŸƒ", "Ø´Ø§Ø±Ùƒ ØµÙˆØ±Ø© Ù…Ø®ÙŠÙØ© ğŸ‘»", "Ø£Ø±Ø³Ù„ Ø±Ù…Ø² Ù…Ø®ÙÙŠ Ù„Ù„Ø¨ÙˆØª ğŸ•¸ï¸"]
medium_tasks = ["Ø­Ù„ Ù„ØºØ² Ø§Ù„Ù‡Ø§Ù„ÙˆÙŠÙ† ğŸ•·ï¸", "Ø§Ø¯Ø¹Ù ØµØ¯ÙŠÙ‚Ù‹Ø§ Ù„Ù„Ø§Ù†Ø¶Ù…Ø§Ù… ğŸƒ", "Ø§Ø¹Ø«Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆÙƒØ± Ø§Ù„Ù…Ø®ÙÙŠ ğŸ‘»"]
hard_task = "Ø£ÙƒÙ…Ù„ 3 Ù…Ù‡Ø§Ù… Ù…ØªÙˆØ³Ø·Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù†Ù‚Ø§Ø· Ù…Ø¶Ø§Ø¹ÙØ© ğŸ†"

# ---------- START COMMAND ----------
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    keyboard = [
        ["ğŸƒ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ø®ÙŠÙØ©", "ğŸ•¸ï¸ Ø§Ù„Ø¬ÙˆØ§Ø¦Ø² Ø§Ù„Ø®Ø§ØµØ©"],
        ["ğŸ‘» Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ù† Ø§Ù„Ø­Ø¯Ø«", "ğŸ† Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©"]
    ]
    await update.message.reply_text(
        "ğŸ‘» Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ **Ø­Ø¯Ø« Ù‡Ø§Ù„ÙˆÙŠÙ†**!\nğŸƒ Ø§ÙƒÙ…Ù„ Ø§Ù„Ù…Ù‡Ø§Ù… ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø¬ÙˆØ§Ø¦Ø² Ù…Ø®ÙŠÙØ©!",
        reply_markup=ReplyKeyboardMarkup(keyboard, resize_keyboard=True)
    )

# ---------- TASK HANDLER ----------
async def handle_message(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user_id = update.message.from_user.id
    text = update.message.text

    # Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù‚Ø§Ø· Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯
    if user_id not in users_points:
        users_points[user_id] = 0

    # Ø§Ù„Ø±Ø¯ Ø¹Ù„Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù‡Ø§Ù…
    if text == "ğŸƒ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ø®ÙŠÙØ©":
        task = random.choice(easy_tasks + medium_tasks)
        await update.message.reply_text(f"ğŸ”® Ù…Ù‡Ù…ØªÙƒ: {task}\nØ£Ø±Ø³Ù„ 'ØªÙ…' Ø¹Ù†Ø¯ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡!")

    elif text == "ğŸ† Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ©":
        await update.message.reply_text(f"ğŸ”¥ Ù…Ù‡Ù…Ø© Ø§Ù„ÙŠÙˆÙ…: {hard_task}\nØ£Ø±Ø³Ù„ 'ØªÙ…' Ø¹Ù†Ø¯ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡!")

    elif text == "ğŸ•¸ï¸ Ø§Ù„Ø¬ÙˆØ§Ø¦Ø² Ø§Ù„Ø®Ø§ØµØ©":
        points = users_points[user_id]
        await update.message.reply_text(f"ğŸ Ù„Ø¯ÙŠÙƒ {points} Ù†Ù‚Ø·Ø© Ø­Ø§Ù„ÙŠÙ‹Ø§!")

    elif text == "ğŸ‘» Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¹Ù† Ø§Ù„Ø­Ø¯Ø«":
        await update.message.reply_text("ğŸ•·ï¸ Ø§Ù„Ø­Ø¯Ø« Ù…Ø³ØªÙ…Ø± Ø­ØªÙ‰ 31 Ø£ÙƒØªÙˆØ¨Ø±!\nØ§ÙƒÙ…Ù„ Ø§Ù„Ù…Ù‡Ø§Ù… ÙˆØ§Ø±Ø¨Ø­ Ø¬ÙˆØ§Ø¦Ø² Ù…Ø®ÙŠÙØ©!")

    # Ø¹Ù†Ø¯ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… "ØªÙ…"
    elif text.lower() == "ØªÙ…":
        # Ù†Ù‚Ø§Ø· Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù…Ù‡Ù…Ø©
        points_earned = random.randint(5, 20)
        users_points[user_id] += points_earned
        await update.message.reply_text(f"âœ… Ø£Ø­Ø³Ù†Øª! Ù„Ù‚Ø¯ Ø±Ø¨Ø­Øª {points_earned} Ù†Ù‚Ø§Ø·!")

    else:
        await update.message.reply_text("âŒ Ø§Ø®ØªØ± Ø®ÙŠØ§Ø± Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø£Ùˆ Ø£Ø±Ø³Ù„ 'ØªÙ…' Ø¹Ù†Ø¯ Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ù…Ù‡Ù…Ø©!")

# ---------- MAIN ----------
app = ApplicationBuilder().token(BOT_TOKEN).build()
app.add_handler(CommandHandler("start", start))
app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_message))

print("Bot is running...")
app.run_polling()
